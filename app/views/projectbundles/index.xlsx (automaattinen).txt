wb = xlsx_package.workbook

wb.add_worksheet(:name => "Projektijaot") do |sheet|
  wide_cells = sheet.styles.add_style widths: 20
  array = ["Opiskelija", "Opiskelijanumero"]
  @projectbundle.projects.each do |proj|
    array << proj.name
  end
  array << "Opiskelijalla projekteja"
  array << "Magic number"
  sheet.add_row array
  stdntArray = []
  projId = 1
  @projectbundle.enrollments.each do |roll|
    stdntArray << roll.name
    stdntArray << roll.studentnumber
    while projId <= @projectbundle.projects.count do
      proju =roll.signups.find_by_project_id(projId)
      if not proju.nil? 
	if proju.status
        	stdntArray << 'Valittu'
	else 
		stdntArray << 'Ei valittu'
	end
      else
        stdntArray << " "
      end
      projId = projId + 1
	great = roll.signups.find_by_status(true)
    end
	if not great.nil?
	stdntArray << great.count
	else
	stdntArray << '0'
	end
	stdntArray << roll.magic_number
    projId = 1
    sheet.add_row stdntArray
    stdntArray = []
  end
	arrayYks = ["Opiskelijoita", ""]
	

end
